'use strict';const a24_0x18bb56=a24_0x37cd;(function(_0x542661,_0x45e220){const _0x5aceea=a24_0x37cd,_0x231053=_0x542661();while(!![]){try{const _0x262171=-parseInt(_0x5aceea(0xd1))/0x1*(parseInt(_0x5aceea(0xc8))/0x2)+-parseInt(_0x5aceea(0xb6))/0x3+parseInt(_0x5aceea(0xd7))/0x4*(parseInt(_0x5aceea(0xab))/0x5)+parseInt(_0x5aceea(0xda))/0x6*(-parseInt(_0x5aceea(0xa9))/0x7)+-parseInt(_0x5aceea(0xbc))/0x8*(-parseInt(_0x5aceea(0xad))/0x9)+-parseInt(_0x5aceea(0xb8))/0xa*(parseInt(_0x5aceea(0xac))/0xb)+parseInt(_0x5aceea(0xdb))/0xc;if(_0x262171===_0x45e220)break;else _0x231053['push'](_0x231053['shift']());}catch(_0x354778){_0x231053['push'](_0x231053['shift']());}}}(a24_0x1220,0x76796));Object['defineProperty'](exports,a24_0x18bb56(0xd0),{'value':!0x0}),exports['initServer']=initServer,exports[a24_0x18bb56(0xc0)]=loadTrunks;var _routesPbx=_interopRequireDefault(require(a24_0x18bb56(0xcf))),_http=require(a24_0x18bb56(0xbf)),_ami=require(a24_0x18bb56(0xb1)),_agi=require(a24_0x18bb56(0xbb)),_ami_events=require(a24_0x18bb56(0xc5)),_leadmob=require(a24_0x18bb56(0xaf)),_cors=_interopRequireDefault(require('cors'));function _interopRequireDefault(_0xa6c1a5){const _0x4d5809=a24_0x18bb56,_0x4f7557=(function(){let _0x4dcd93=!![];return function(_0x80ea07,_0x30597f){const _0x504672=_0x4dcd93?function(){const _0x32b180=a24_0x37cd;if(_0x30597f){const _0x184f3b=_0x30597f[_0x32b180(0xcc)](_0x80ea07,arguments);return _0x30597f=null,_0x184f3b;}}:function(){};return _0x4dcd93=![],_0x504672;};}()),_0x516b73=_0x4f7557(this,function(){const _0x5c5574=a24_0x37cd;return _0x516b73[_0x5c5574(0xb3)]()[_0x5c5574(0xc3)](_0x5c5574(0xca))[_0x5c5574(0xb3)]()[_0x5c5574(0xd8)](_0x516b73)['search'](_0x5c5574(0xca));});return _0x516b73(),_0xa6c1a5&&_0xa6c1a5[_0x4d5809(0xd0)]?_0xa6c1a5:{'default':_0xa6c1a5};}function a24_0x37cd(_0x5ee2fd,_0x273cce){const _0x328cfd=a24_0x1220();return a24_0x37cd=function(_0x590abc,_0x32054c){_0x590abc=_0x590abc-0xa9;let _0x122056=_0x328cfd[_0x590abc];return _0x122056;},a24_0x37cd(_0x5ee2fd,_0x273cce);}const express=require('express'),{connectToDatabase,getSipPeers}=require(a24_0x18bb56(0xd4));require(a24_0x18bb56(0xb7))[a24_0x18bb56(0xd5)](),global[a24_0x18bb56(0xd2)]=[];async function loadTrunks(){const _0x42b7a7=a24_0x18bb56;try{await connectToDatabase()['then'](_0x5242ec=>{const _0x595e5c=a24_0x37cd;_0x5242ec[_0x595e5c(0xcb)](_0x515429=>{const _0x3e780a=_0x595e5c;global[_0x3e780a(0xd2)]['push'](_0x515429[_0x3e780a(0xb2)]);});}),await getSipPeers()[_0x42b7a7(0xc7)](_0x367ce2=>{const _0x4d14e9=_0x42b7a7;_0x367ce2[_0x4d14e9(0xcb)](_0x3db6ee=>{const _0x1fbf86=_0x4d14e9;global[_0x1fbf86(0xd2)][_0x1fbf86(0xce)](_0x3db6ee['id']+_0x1fbf86(0xaa));});}),console['log'](_0x42b7a7(0xc4),global['trunks']);}catch(_0x10c7bc){throw console[_0x42b7a7(0xc2)](_0x42b7a7(0xd3),_0x10c7bc),_0x10c7bc;}}async function initServer(){const _0x3fdd32=a24_0x18bb56,_0x27da2a=express(),_0x3366f5=new _http[(_0x3fdd32(0xb5))](_0x27da2a);_0x27da2a[_0x3fdd32(0xc1)]((0x0,_cors[_0x3fdd32(0xcd)])()),_0x27da2a['use'](express['json']()),_0x27da2a[_0x3fdd32(0xc1)](_0x3fdd32(0xb4),_routesPbx[_0x3fdd32(0xcd)]);try{await loadTrunks(),await(0x0,_ami[_0x3fdd32(0xba)])(),await(0x0,_agi['initAgi'])(),setTimeout(async()=>{const _0x1b8c1b=_0x3fdd32;await(0x0,_ami_events[_0x1b8c1b(0xc9)])(),console[_0x1b8c1b(0xbd)](await(0x0,_leadmob[_0x1b8c1b(0xc6)])(_0x1b8c1b(0xb0)));},0x1388);const _0x29fbbe=process[_0x3fdd32(0xb9)][_0x3fdd32(0xd9)]||0xbb8;_0x3366f5['listen'](_0x29fbbe,()=>{const _0x16fa55=_0x3fdd32;console['log'](_0x16fa55(0xd6)+_0x29fbbe);});}catch(_0x2de258){console[_0x3fdd32(0xc2)](_0x3fdd32(0xae),_0x2de258),console['error'](_0x3fdd32(0xbe)),process['exit'](0x1);}}function a24_0x1220(){const _0x45c801=['Reiniciando\x20a\x20API...','http','loadTrunks','use','error','search','TRUNKS\x20carregados:','./ami/ami_events','getCachedLeadmobData','then','2pTTTho','initHandleEvents','(((.+)+)+)+$','map','apply','default','push','./routes/routesPbx','__esModule','16404otogVr','trunks','Erro\x20ao\x20carregar\x20troncos:','./ami/getTrunks','config','Server\x20is\x20running\x20on\x20port:\x20','816548LHvmgU','constructor','PORT_API','126RDrEnj','22942404dMoRgt','67557SjrdAc','@from-queue','5EaffrG','11kpRTph','3231KwfJlH','Erro\x20ao\x20inicializar\x20AMI:','./service/leadmob','11933464180','./ami/ami','name','toString','/api/ipbx','createServer','2248650gIgdQv','dotenv','6829310kHidrV','env','initAmi','./agi/agi','464QKcArV','log'];a24_0x1220=function(){return _0x45c801;};return a24_0x1220();}