const a18_0x866f3=a18_0x1dba;function a18_0x1dba(_0x1074cf,_0x294b84){const _0x43ed5a=a18_0x1f98();return a18_0x1dba=function(_0x56b1af,_0x2be3aa){_0x56b1af=_0x56b1af-0xa6;let _0x1f9831=_0x43ed5a[_0x56b1af];return _0x1f9831;},a18_0x1dba(_0x1074cf,_0x294b84);}function a18_0x1f98(){const _0x165af5=['split','Chamou\x20Rota\x20ClickToCall','(((.+)+)+)+$','reduce','Erro\x20ao\x20fazer\x20chamada:','ramal','4BrAOIG','5438AFhgGr','core\x20show\x20channels\x20concise','stdout','2507004bSxOmc','constructor','ramal_origin','then','error','beforePoint','Exec','destination','uniqueID','Reiniciando\x20a\x20API...','message','UNIQUEID:','exit','@from-internal','28136phiuHZ','181975hRkpPN','Local/','815073dVKioL','Originate','>;answer-after=0\x22','lastFourDigits','toString','clickToCall','@PICKUPMARK)','log','Pickup(','Atxfer','undefined','includes','search','2725930NQZpkY','push','Parametros\x20Inv√°lidos','exec','from-internal','./ami','answer','map','catch','forEach','action','SIPADDHEADER=\x22Call-Info:\x20<sip:','connect','>;answer-after=0','553XmzOgO','caller','ERROR:\x20','length','defineProperty','63stsrNx','11720368PcbRjg','30yOOxhT'];a18_0x1f98=function(){return _0x165af5;};return a18_0x1f98();}(function(_0x144af1,_0x37dd05){const _0x1df0a2=a18_0x1dba,_0x3220ef=_0x144af1();while(!![]){try{const _0x19ce75=-parseInt(_0x1df0a2(0xae))/0x1*(parseInt(_0x1df0a2(0xb8))/0x2)+-parseInt(_0x1df0a2(0xcc))/0x3*(parseInt(_0x1df0a2(0xb7))/0x4)+-parseInt(_0x1df0a2(0xca))/0x5*(parseInt(_0x1df0a2(0xb0))/0x6)+parseInt(_0x1df0a2(0xa9))/0x7*(-parseInt(_0x1df0a2(0xc9))/0x8)+-parseInt(_0x1df0a2(0xbb))/0x9+parseInt(_0x1df0a2(0xd9))/0xa+parseInt(_0x1df0a2(0xaf))/0xb;if(_0x19ce75===_0x37dd05)break;else _0x3220ef['push'](_0x3220ef['shift']());}catch(_0x1cfc88){_0x3220ef['push'](_0x3220ef['shift']());}}}(a18_0x1f98,0x2642f));const a18_0x2be3aa=(function(){let _0x4e276b=!![];return function(_0x22a87f,_0x3c0a10){const _0x29c810=_0x4e276b?function(){if(_0x3c0a10){const _0x3b64aa=_0x3c0a10['apply'](_0x22a87f,arguments);return _0x3c0a10=null,_0x3b64aa;}}:function(){};return _0x4e276b=![],_0x29c810;};}()),a18_0x56b1af=a18_0x2be3aa(this,function(){const _0x5e89ac=a18_0x1dba;return a18_0x56b1af['toString']()[_0x5e89ac(0xd8)]('(((.+)+)+)+$')[_0x5e89ac(0xd0)]()[_0x5e89ac(0xbc)](a18_0x56b1af)['search'](_0x5e89ac(0xb3));});a18_0x56b1af();'use strict';Object[a18_0x866f3(0xad)](exports,'__esModule',{'value':!0x0}),exports[a18_0x866f3(0xdf)]=answer,exports[a18_0x866f3(0xd1)]=clickToCall,exports['transfer']=transfer;var _ami=require(a18_0x866f3(0xde)),exec=require('child-process-promise')[a18_0x866f3(0xdc)];async function command(_0x563415){return new Promise((_0x25ad01,_0x5321c7)=>{const _0x4a76ab=a18_0x1dba;exec('asterisk\x20-rx\x20\x27'+_0x563415+'\x27')[_0x4a76ab(0xbe)](function(_0x56722c){const _0x541b8f=_0x4a76ab;var _0x34df33=_0x56722c[_0x541b8f(0xba)],_0x1c44d9=_0x56722c['stderr'];return _0x1c44d9?_0x5321c7(_0x1c44d9):_0x25ad01(_0x34df33);})[_0x4a76ab(0xe1)](function(_0x23021a){const _0x450e61=_0x4a76ab;console[_0x450e61(0xbf)](_0x450e61(0xab),_0x23021a);});});}function timeDelay(){return new Promise(_0x3e74ff=>{setTimeout(()=>{_0x3e74ff();},0x578);});}function getMaxFullNumberMinusOne(_0x4bcb20){const _0xed179c=a18_0x866f3,_0x3ea843=_0x4bcb20[_0xed179c(0xe0)](_0xfe4e79=>{const _0x3ef4cb=_0xed179c,[_0x2e388d,_0x2ae94b]=_0xfe4e79[_0x3ef4cb(0xb1)]('.'),_0x44263e=parseInt(_0x2ae94b);return{'beforePoint':_0x2e388d,'lastFourDigits':_0x44263e};}),_0x37aa03=_0x3ea843[_0xed179c(0xb4)]((_0x909fa6,_0x18578b)=>_0x18578b['lastFourDigits']>_0x909fa6['lastFourDigits']?_0x18578b:_0x909fa6),_0x4d04ae=_0x37aa03[_0xed179c(0xcf)]-0x1;return _0x37aa03[_0xed179c(0xc0)]+'.'+_0x4d04ae['toString']();}async function clickToCall(_0x1e5402,_0x33457b){const _0x4a9464=a18_0x866f3;try{return console[_0x4a9464(0xd3)](_0x4a9464(0xb2),_0x1e5402),await _ami['customAmiClient'][_0x4a9464(0xe3)]({'Action':_0x4a9464(0xcd),'Exten':''+_0x1e5402[_0x4a9464(0xc2)],'Priority':'1','Variable':_0x4a9464(0xa6)+_0x33457b+_0x4a9464(0xce),'Channel':'Local/'+_0x1e5402[_0x4a9464(0xb6)],'CallerID':_0x1e5402[_0x4a9464(0xc2)],'Context':_0x4a9464(0xdd)},!0x0,0x7530)[_0x4a9464(0xbe)](async _0x257d68=>{const _0x3ae520=_0x4a9464;let _0x4b0ab4=await command(_0x3ae520(0xb9)),_0x59ae6c=[];return _0x4b0ab4=_0x4b0ab4[_0x3ae520(0xb1)]('\x0a'),_0x4b0ab4['forEach'](_0xdcc676=>{const _0x536d8c=_0x3ae520;if(_0xdcc676['split']('!')[0x0][_0x536d8c(0xd7)](_0x1e5402[_0x536d8c(0xb6)])||_0xdcc676[_0x536d8c(0xb1)]('!')[0x0][_0x536d8c(0xd7)](_0x1e5402[_0x536d8c(0xc2)])){console[_0x536d8c(0xd3)](_0xdcc676);const _0x2d8884=_0xdcc676[_0x536d8c(0xb1)]('!'),_0x42087e=_0x2d8884[_0x2d8884[_0x536d8c(0xac)]-0x1];_0x59ae6c[_0x536d8c(0xda)](_0x42087e);}}),0x0<_0x59ae6c[_0x3ae520(0xac)]?(_0x257d68[_0x3ae520(0xc3)]=getMaxFullNumberMinusOne(_0x59ae6c),console[_0x3ae520(0xd3)](_0x3ae520(0xc6),_0x257d68['uniqueID'])):(_0x257d68['uniqueID']=null,console['log']('UNIQUEID\x20Inexistente.')),console[_0x3ae520(0xd3)](_0x257d68),_0x257d68;})['catch'](_0x475b8f=>{const _0x870742=_0x4a9464;console[_0x870742(0xd3)](_0x475b8f);});}catch(_0x29a5dd){return console[_0x4a9464(0xbf)](_0x4a9464(0xb5),_0x29a5dd),_0x29a5dd instanceof Error&&_0x29a5dd?.['message']?.['includes'](_0x4a9464(0xa7))&&(console['error'](_0x4a9464(0xc4)),process[_0x4a9464(0xc7)](0x1)),{'error':_0x29a5dd[_0x4a9464(0xc5)]};}}async function transfer(_0x4a30b0){return new Promise(async(_0x52d209,_0x257b0f)=>{const _0x9390=a18_0x1dba;let _0x42f0fc='',_0x371068=await command(_0x9390(0xb9));_0x371068=_0x371068[_0x9390(0xb1)]('\x0a'),_0x371068[_0x9390(0xe2)](_0x288095=>{const _0x4bb938=_0x9390;if(_0x288095[_0x4bb938(0xb1)]('!')[0x0][_0x4bb938(0xd7)](_0x4a30b0[_0x4bb938(0xbd)]))return void(_0x42f0fc=_0x288095[_0x4bb938(0xb1)]('!')[0x0]);}),''==_0x42f0fc?_0x257b0f('Channel\x20not\x20found'):_0x52d209(amiClient[_0x9390(0xe3)]({'Action':_0x9390(0xd5),'Exten':_0x4a30b0['ramal_destination'],'Priority':'1','Channel':_0x42f0fc,'Context':'from-internal'}));});}async function answer(_0x1b1933){return new Promise(async(_0x51543b,_0x31915a)=>{const _0x514e69=a18_0x1dba;_0x514e69(0xd6)==_0x1b1933['ramal_origin']||''==_0x1b1933[_0x514e69(0xbd)]||''==_0x1b1933[_0x514e69(0xaa)]?_0x31915a(_0x514e69(0xdb)):_0x51543b(amiClient['action']({'Action':_0x514e69(0xcd),'Channel':_0x514e69(0xcb)+_0x1b1933[_0x514e69(0xbd)]+_0x514e69(0xc8),'Application':_0x514e69(0xc1),'CallerID':_0x1b1933['caller'],'Variable':_0x514e69(0xa6)+ipAddress+_0x514e69(0xa8),'Data':_0x514e69(0xd4)+_0x1b1933[_0x514e69(0xbd)]+'&'+_0x1b1933['ramal_origin']+_0x514e69(0xd2)},!0x0));});}